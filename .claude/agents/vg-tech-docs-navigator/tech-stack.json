{
  "version": "1.0.0",
  "last_updated": "2025-11-09",
  "description": "Technical documentation hub for all technologies used in Vigil Guard",
  "technologies": {
    "express": {
      "name": "Express.js",
      "version": "^4.19.2",
      "category": "backend",
      "official_docs": "https://expressjs.com/en/5x/api.html",
      "quick_links": {
        "routing": "https://expressjs.com/en/guide/routing.html",
        "middleware": "https://expressjs.com/en/guide/using-middleware.html",
        "error_handling": "https://expressjs.com/en/guide/error-handling.html",
        "request": "https://expressjs.com/en/5x/api.html#req",
        "response": "https://expressjs.com/en/5x/api.html#res"
      },
      "used_in": [
        "services/web-ui/backend"
      ],
      "common_apis": [
        {
          "name": "app.use(middleware)",
          "description": "Mount middleware at the specified path",
          "example": "app.use(express.json())"
        },
        {
          "name": "app.get(path, handler)",
          "description": "Routes HTTP GET requests to the specified path",
          "example": "app.get('/api/users', authMiddleware, getUsers)"
        },
        {
          "name": "app.post(path, handler)",
          "description": "Routes HTTP POST requests to the specified path",
          "example": "app.post('/api/login', loginHandler)"
        },
        {
          "name": "res.json(body)",
          "description": "Send JSON response",
          "example": "res.json({ success: true, data: users })"
        },
        {
          "name": "res.status(code)",
          "description": "Set HTTP status code",
          "example": "res.status(404).json({ error: 'Not found' })"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Middleware order matters",
          "description": "express.json() must be registered before route handlers that need parsed body",
          "solution": "Place body parsers (express.json(), express.urlencoded()) before route definitions",
          "example": "app.use(express.json()); // MUST come before routes"
        },
        {
          "issue": "Error handlers must have 4 parameters",
          "description": "Express identifies error-handling middleware by function arity (number of parameters)",
          "solution": "Always use signature: (err, req, res, next) => {...}",
          "example": "app.use((err, req, res, next) => { res.status(500).json({ error: err.message }); })"
        },
        {
          "issue": "Cannot set headers after they are sent",
          "description": "Trying to send response multiple times or after response is already sent",
          "solution": "Use return after res.json() or res.send(), check for early returns in middleware",
          "example": "return res.status(401).json({ error: 'Unauthorized' }); // return prevents further execution"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "JWT Authentication Middleware",
          "file": "services/web-ui/backend/src/auth.ts",
          "lines": "99-111",
          "description": "authMiddleware implementation with JWT verification"
        },
        {
          "pattern": "Rate Limiting Middleware",
          "file": "services/web-ui/backend/src/server.ts",
          "lines": "45-63",
          "description": "express-rate-limit configuration for login and API endpoints"
        },
        {
          "pattern": "CORS Configuration",
          "file": "services/web-ui/backend/src/server.ts",
          "lines": "34-43",
          "description": "CORS setup with origin validation regex"
        }
      ],
      "best_practices": [
        "Always use async error wrapper for async route handlers",
        "Implement proper CORS configuration (don't use origin: '*' in production)",
        "Use express.json() and express.urlencoded() for body parsing",
        "Set security headers with helmet middleware (if applicable)",
        "Handle errors with centralized error handler",
        "Use environment variables for configuration",
        "Validate input before processing"
      ]
    },
    "react": {
      "name": "React",
      "version": "^18.3.1",
      "category": "frontend",
      "official_docs": "https://react.dev/",
      "quick_links": {
        "hooks": "https://react.dev/reference/react",
        "components": "https://react.dev/learn/your-first-component",
        "state": "https://react.dev/learn/state-a-components-memory",
        "effects": "https://react.dev/learn/synchronizing-with-effects",
        "context": "https://react.dev/learn/passing-data-deeply-with-context"
      },
      "used_in": [
        "services/web-ui/frontend"
      ],
      "common_apis": [
        {
          "name": "useState(initialValue)",
          "description": "Declare a state variable that React will preserve between re-renders",
          "example": "const [count, setCount] = useState(0)"
        },
        {
          "name": "useEffect(setup, dependencies?)",
          "description": "Synchronize component with external system",
          "example": "useEffect(() => { fetchData(); }, [])"
        },
        {
          "name": "useContext(Context)",
          "description": "Read and subscribe to context",
          "example": "const user = useContext(UserContext)"
        },
        {
          "name": "useMemo(calculate, dependencies)",
          "description": "Cache expensive calculation result",
          "example": "const sortedList = useMemo(() => list.sort(), [list])"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Controlled components not updating visually",
          "description": "Component value doesn't reflect pending changes when using controlled inputs",
          "solution": "Use getCurrentValue() helper to merge original state + pending changes",
          "vigil_guard_fix": "services/web-ui/frontend/src/components/ConfigSection.tsx lines 59-72",
          "example": "<Select value={getCurrentValue(file, mapping, originalValue)} onChange={handleChange} />"
        },
        {
          "issue": "useEffect infinite loop",
          "description": "Effect runs continuously because dependencies change on every render",
          "solution": "Add all used variables to dependency array, use useMemo/useCallback for object/function dependencies",
          "example": "useEffect(() => { fetch(url); }, [url]); // Include url in deps"
        },
        {
          "issue": "State not updating immediately",
          "description": "setState is async, console.log shows old value",
          "solution": "Use useEffect to react to state changes, or pass updater function to setState",
          "example": "setCount(prev => prev + 1); // Use updater function"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "getCurrentValue() Helper for Controlled Components",
          "file": "services/web-ui/frontend/src/components/ConfigSection.tsx",
          "lines": "59-72",
          "description": "CRITICAL pattern for controlled components with pending changes - merges original + modified state"
        },
        {
          "pattern": "Protected Route with RBAC",
          "file": "services/web-ui/frontend/src/components/ProtectedRoute.tsx",
          "description": "Route wrapper checking user permissions"
        },
        {
          "pattern": "API Error Handling with Toast",
          "file": "services/web-ui/frontend/src/components/ConfigSection.tsx",
          "description": "Consistent error display pattern using react-hot-toast"
        }
      ],
      "best_practices": [
        "Use functional components with hooks (not class components)",
        "Keep components small and focused (single responsibility)",
        "Memoize expensive computations with useMemo",
        "Extract custom hooks for reusable stateful logic",
        "Use TypeScript for type safety",
        "Follow React naming conventions (PascalCase for components)",
        "Avoid inline object/function creation in render (causes re-renders)"
      ]
    },
    "vitest": {
      "name": "Vitest",
      "version": "^1.6.1",
      "category": "testing",
      "official_docs": "https://vitest.dev/guide/",
      "quick_links": {
        "api": "https://vitest.dev/api/",
        "config": "https://vitest.dev/config/",
        "coverage": "https://vitest.dev/guide/coverage",
        "mocking": "https://vitest.dev/guide/mocking"
      },
      "used_in": [
        "services/workflow/tests"
      ],
      "common_apis": [
        {
          "name": "describe(name, fn)",
          "description": "Create a test suite",
          "example": "describe('Auth API', () => { test('should login', ...) })"
        },
        {
          "name": "test(name, fn, timeout?)",
          "description": "Define a test case",
          "example": "test('should detect SQL injection', async () => {...}, 30000)"
        },
        {
          "name": "expect(value)",
          "description": "Create assertion",
          "example": "expect(response.status).toBe(200)"
        },
        {
          "name": "beforeEach(fn)",
          "description": "Run setup before each test",
          "example": "beforeEach(() => { resetDatabase(); })"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Webhook timeout in sequential mode",
          "description": "Tests timeout when hitting n8n webhook endpoint (default 5s too short)",
          "solution": "Increase timeout to 30s in test or vitest.config.js",
          "vigil_guard_fix": "services/workflow/vitest.config.js testTimeout: 30000",
          "example": "test('webhook test', async () => {...}, 30000) // 30s timeout"
        },
        {
          "issue": "Tests pass individually but fail in suite",
          "description": "Race conditions or shared state between tests",
          "solution": "Use beforeEach/afterEach for cleanup, avoid shared mutable state",
          "example": "beforeEach(() => { mockClear(); })"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "Webhook Testing Helper",
          "file": "services/workflow/tests/helpers/webhook.js",
          "description": "Helper function for testing n8n workflow via webhook endpoint"
        },
        {
          "pattern": "TDD Pattern Addition Workflow",
          "file": "services/workflow/tests/e2e/bypass-scenarios.test.js",
          "description": "Test-driven approach: create failing test → add pattern → verify pass"
        }
      ],
      "best_practices": [
        "Use describe/test for clear test organization",
        "Use beforeEach/afterEach for setup/teardown (avoid shared state)",
        "Mock external services (APIs, databases)",
        "Test behavior, not implementation details",
        "Maintain >85% test pass rate",
        "Use meaningful test names (should...)",
        "Keep tests isolated and independent"
      ]
    },
    "docker": {
      "name": "Docker",
      "version": "latest",
      "category": "infrastructure",
      "official_docs": "https://docs.docker.com/",
      "quick_links": {
        "dockerfile": "https://docs.docker.com/reference/dockerfile/",
        "compose": "https://docs.docker.com/compose/compose-file/",
        "networking": "https://docs.docker.com/network/",
        "volumes": "https://docs.docker.com/storage/volumes/"
      },
      "used_in": [
        "docker-compose.yml",
        "services/*/Dockerfile"
      ],
      "common_apis": [
        {
          "name": "docker-compose up -d",
          "description": "Start all services in detached mode",
          "example": "docker-compose up -d"
        },
        {
          "name": "docker-compose logs -f <service>",
          "description": "View and follow service logs",
          "example": "docker-compose logs -f web-ui-backend"
        },
        {
          "name": "docker-compose down",
          "description": "Stop and remove containers",
          "example": "docker-compose down"
        },
        {
          "name": "docker-compose build --no-cache",
          "description": "Rebuild images from scratch",
          "example": "docker-compose build --no-cache n8n"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Port already in use",
          "description": "Service fails to start because port is occupied",
          "solution": "Find and kill process using lsof -i :<port>, then kill -9 <PID>",
          "example": "lsof -i :8123 && kill -9 <PID>"
        },
        {
          "issue": "Volume permissions on macOS",
          "description": "Container can't write to mounted volumes",
          "solution": "Set GRAFANA_UID/GID in .env matching host user",
          "vigil_guard_fix": ".env GRAFANA_UID=$(id -u), GRAFANA_GID=$(id -g)"
        },
        {
          "issue": "Network not found after recreating containers",
          "description": "vigil-net network doesn't exist",
          "solution": "docker network create vigil-net OR docker-compose up (creates automatically)",
          "example": "docker network create vigil-net"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "9-Service Orchestration",
          "file": "docker-compose.yml",
          "description": "Complete service stack with dependencies, networks, volumes"
        },
        {
          "pattern": "Environment Variables Management",
          "file": ".env",
          "description": "Centralized secrets and configuration (auto-generated by install.sh)"
        }
      ],
      "best_practices": [
        "Use .env for secrets (never commit)",
        "Define explicit dependencies (depends_on)",
        "Use named volumes for persistence",
        "Use custom networks for service isolation",
        "Pin image versions (avoid 'latest' in production)",
        "Implement health checks for critical services",
        "Use multi-stage builds to reduce image size"
      ]
    },
    "clickhouse": {
      "name": "ClickHouse",
      "version": "25.10.1",
      "category": "database",
      "official_docs": "https://clickhouse.com/docs/en/intro",
      "quick_links": {
        "sql": "https://clickhouse.com/docs/en/sql-reference",
        "functions": "https://clickhouse.com/docs/en/sql-reference/functions",
        "data_types": "https://clickhouse.com/docs/en/sql-reference/data-types",
        "table_engines": "https://clickhouse.com/docs/en/engines/table-engines"
      },
      "used_in": [
        "services/monitoring/clickhouse",
        "services/web-ui/backend (queries)"
      ],
      "common_apis": [
        {
          "name": "SELECT ... FROM ... WHERE ...",
          "description": "Query data with filtering",
          "example": "SELECT * FROM n8n_logs WHERE timestamp > now() - INTERVAL 1 DAY"
        },
        {
          "name": "INSERT INTO ... VALUES ...",
          "description": "Insert data into table",
          "example": "INSERT INTO n8n_logs (timestamp, event) VALUES (now(), 'test')"
        },
        {
          "name": "CREATE TABLE ... ENGINE = MergeTree",
          "description": "Create table with MergeTree engine",
          "example": "CREATE TABLE logs (...) ENGINE = MergeTree() ORDER BY timestamp"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Map type requires special handling",
          "description": "score_breakdown column uses Map(String, Float64) type",
          "solution": "Insert as map('key', value), query with mapKeys/mapValues",
          "vigil_guard_fix": "services/workflow/workflows/Vigil-Guard-v1.6.11.json - Map insertion pattern"
        },
        {
          "issue": "TTL not deleting old data",
          "description": "Retention policy not working as expected",
          "solution": "Check TTL expression syntax and OPTIMIZE TABLE to trigger cleanup",
          "example": "ALTER TABLE n8n_logs MODIFY TTL timestamp + INTERVAL 90 DAY"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "Event Logging Schema",
          "file": "services/monitoring/clickhouse/init-db.sh",
          "description": "n8n_logs table with Map type for score_breakdown"
        },
        {
          "pattern": "Retention Policy",
          "file": "services/web-ui/backend/src/retention.ts",
          "description": "TTL management via API"
        }
      ],
      "best_practices": [
        "Use MergeTree engine for analytical queries",
        "Index by timestamp for time-series data",
        "Use Map type for dynamic key-value pairs",
        "Implement TTL for data lifecycle management",
        "Partition large tables by date",
        "Use materialized views for aggregations"
      ]
    },
    "typescript": {
      "name": "TypeScript",
      "version": "^5.5.4",
      "category": "language",
      "official_docs": "https://www.typescriptlang.org/docs/",
      "quick_links": {
        "handbook": "https://www.typescriptlang.org/docs/handbook/intro.html",
        "utility_types": "https://www.typescriptlang.org/docs/handbook/utility-types.html",
        "tsconfig": "https://www.typescriptlang.org/tsconfig"
      },
      "used_in": [
        "services/web-ui/backend",
        "services/web-ui/frontend"
      ],
      "common_apis": [
        {
          "name": "interface",
          "description": "Define object type structure",
          "example": "interface User { id: number; name: string; }"
        },
        {
          "name": "type",
          "description": "Create type alias",
          "example": "type Status = 'pending' | 'completed'"
        },
        {
          "name": "Partial<T>",
          "description": "Make all properties optional",
          "example": "type PartialUser = Partial<User>"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "any type defeats type checking",
          "description": "Using 'any' disables type safety",
          "solution": "Use 'unknown' and type guards, or define proper types",
          "example": "const data: unknown = JSON.parse(str); if (typeof data === 'object') {...}"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "API Response Types",
          "file": "services/web-ui/backend/src/types.ts",
          "description": "Type definitions for API contracts"
        }
      ],
      "best_practices": [
        "Enable strict mode in tsconfig.json",
        "Avoid 'any' type (use 'unknown' instead)",
        "Use interfaces for object shapes",
        "Use type aliases for unions/primitives",
        "Leverage utility types (Partial, Pick, Omit)"
      ]
    },
    "vite": {
      "name": "Vite",
      "version": "^5.4.0",
      "category": "build_tool",
      "official_docs": "https://vite.dev/guide/",
      "quick_links": {
        "config": "https://vite.dev/config/",
        "features": "https://vite.dev/guide/features",
        "api": "https://vite.dev/guide/api-javascript"
      },
      "used_in": [
        "services/web-ui/frontend"
      ],
      "common_apis": [
        {
          "name": "vite.config.ts",
          "description": "Vite configuration file",
          "example": "export default defineConfig({ base: '/ui/', server: { proxy: {...} } })"
        },
        {
          "name": "import.meta.env",
          "description": "Access environment variables",
          "example": "const apiUrl = import.meta.env.VITE_API_URL"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Assets not loading after deployment",
          "description": "Incorrect base path configuration",
          "solution": "Set base: '/ui/' in vite.config.ts to match deployment path",
          "vigil_guard_fix": "services/web-ui/frontend/vite.config.ts base: '/ui/'"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "Proxy Configuration for API",
          "file": "services/web-ui/frontend/vite.config.ts",
          "description": "Proxy /api to backend during development"
        }
      ],
      "best_practices": [
        "Use import.meta.env for environment variables",
        "Configure base path for deployment",
        "Use proxy for API during development",
        "Leverage HMR for fast development"
      ]
    },
    "tailwindcss": {
      "name": "Tailwind CSS",
      "version": "^4.0.0",
      "category": "styling",
      "official_docs": "https://tailwindcss.com/docs",
      "quick_links": {
        "installation": "https://tailwindcss.com/docs/installation",
        "configuration": "https://tailwindcss.com/docs/configuration",
        "utility_classes": "https://tailwindcss.com/docs/utility-first"
      },
      "used_in": [
        "services/web-ui/frontend"
      ],
      "common_apis": [
        {
          "name": "Utility classes",
          "description": "Pre-defined CSS classes",
          "example": "className=\"flex items-center justify-between p-4 bg-gray-100\""
        },
        {
          "name": "@apply directive",
          "description": "Extract component classes",
          "example": "@apply flex items-center gap-2;"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "v4 uses CSS-first configuration",
          "description": "Tailwind v4 changed configuration approach",
          "solution": "Use @theme directive in CSS, not tailwind.config.js",
          "vigil_guard_fix": "services/web-ui/frontend/src/index.css uses @theme"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "Theme Configuration",
          "file": "services/web-ui/frontend/src/index.css",
          "description": "Tailwind v4 theme using @theme directive"
        }
      ],
      "best_practices": [
        "Use utility-first approach",
        "Extract components with @apply when needed",
        "Use responsive modifiers (sm:, md:, lg:)",
        "Leverage custom theme variables"
      ]
    },
    "n8n": {
      "name": "n8n",
      "version": "1.118.2",
      "category": "workflow",
      "official_docs": "https://docs.n8n.io/",
      "quick_links": {
        "nodes": "https://docs.n8n.io/integrations/builtin/core-nodes/",
        "code": "https://docs.n8n.io/code/builtin/",
        "workflows": "https://docs.n8n.io/workflows/"
      },
      "used_in": [
        "services/workflow"
      ],
      "common_apis": [
        {
          "name": "Code node - JavaScript",
          "description": "Execute custom JavaScript in workflow",
          "example": "const result = items.map(item => ({ json: { ...item.json, processed: true } })); return result;"
        },
        {
          "name": "$input.all()",
          "description": "Access all input items",
          "example": "const items = $input.all();"
        },
        {
          "name": "$json",
          "description": "Access current item's JSON data",
          "example": "const text = $json.message;"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Workflow changes not persisted",
          "description": "n8n reads from SQLite database, not JSON file",
          "solution": "ALWAYS save changes to workflow JSON file AND import to n8n GUI",
          "vigil_guard_fix": "CRITICAL: Edit JSON → Tell user to import via n8n GUI"
        },
        {
          "issue": "Flags lost when creating new objects in Code nodes",
          "description": "New result object doesn't preserve _pii_sanitized, pii_classification from previous nodes",
          "solution": "Copy all flags from input item before returning",
          "vigil_guard_fix": "services/workflow/workflows/Vigil-Guard-v1.7.0.json - Finale Decision node pattern",
          "example": "return [{ json: { ...newData, _pii_sanitized: $json._pii_sanitized, pii_classification: $json.pii_classification } }];"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "40-Node Detection Pipeline",
          "file": "services/workflow/workflows/Vigil-Guard-v1.6.11.json",
          "description": "Sequential processing: validation → PII → normalization → pattern matching → decision"
        },
        {
          "pattern": "Flag Preservation Pattern",
          "file": "services/workflow/workflows/Vigil-Guard-v1.7.0.json",
          "description": "Copying _pii_sanitized, pii_classification, pii flags when creating new objects"
        }
      ],
      "best_practices": [
        "Always import workflow after editing JSON",
        "Preserve flags when creating new objects in Code nodes",
        "Use $input.all() for multiple items",
        "Test workflow in n8n GUI after changes",
        "Export workflow to JSON for version control"
      ]
    },
    "presidio": {
      "name": "Microsoft Presidio",
      "version": "2.2.355",
      "category": "ai",
      "official_docs": "https://microsoft.github.io/presidio/",
      "quick_links": {
        "analyzer": "https://microsoft.github.io/presidio/analyzer/",
        "anonymizer": "https://microsoft.github.io/presidio/anonymizer/",
        "supported_entities": "https://microsoft.github.io/presidio/supported_entities/"
      },
      "used_in": [
        "services/presidio-pii-api"
      ],
      "common_apis": [
        {
          "name": "POST /analyze",
          "description": "Analyze text for PII entities",
          "example": "{\"text\": \"My email is test@example.com\", \"language\": \"en\", \"entities\": [\"EMAIL\"]}"
        },
        {
          "name": "POST /anonymize",
          "description": "Anonymize PII in text",
          "example": "{\"text\": \"...\", \"analyzer_results\": [...]}"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Entity deduplication needed",
          "description": "Presidio returns overlapping entities (e.g., PERSON + PHONE_NUMBER for same span)",
          "solution": "Sort by score DESC, remove overlapping entities, keep highest-score match",
          "vigil_guard_fix": "services/web-ui/backend/src/piiAnalyzer.ts deduplication logic"
        },
        {
          "issue": "AnalysisExplanation not JSON serializable",
          "description": "HTTP 500 when returning entity explanation",
          "solution": "Convert to dict before JSON response",
          "vigil_guard_fix": "services/presidio-pii-api/app.py lines 578-591"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "Dual-Language Detection",
          "file": "services/web-ui/backend/src/piiAnalyzer.ts",
          "description": "Parallel Polish + English analysis with entity deduplication"
        },
        {
          "pattern": "Custom Recognizers (PESEL, NIP, REGON)",
          "file": "services/presidio-pii-api/recognizers/",
          "description": "Polish-specific entity recognition"
        }
      ],
      "best_practices": [
        "Use both Polish and English models for comprehensive coverage",
        "Implement entity deduplication to avoid duplicates",
        "Add regex fallback for entities missed by ML models",
        "Configure confidence threshold (0.0-1.0)",
        "Use custom recognizers for domain-specific entities"
      ]
    },
    "spacy": {
      "name": "spaCy",
      "version": ">=3.7.0 <4.0.0",
      "category": "ai",
      "official_docs": "https://spacy.io/api",
      "quick_links": {
        "models": "https://spacy.io/models",
        "pipeline": "https://spacy.io/usage/processing-pipelines",
        "linguistic_features": "https://spacy.io/usage/linguistic-features"
      },
      "used_in": [
        "services/presidio-pii-api (NLP engine for Presidio)"
      ],
      "common_apis": [
        {
          "name": "spacy.load(model_name)",
          "description": "Load language model",
          "example": "nlp = spacy.load('en_core_web_lg')"
        },
        {
          "name": "nlp(text)",
          "description": "Process text with NLP pipeline",
          "example": "doc = nlp('My email is test@example.com')"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Model not downloaded",
          "description": "Models not included in spacy package, must download separately",
          "solution": "python -m spacy download en_core_web_lg && python -m spacy download pl_core_news_lg",
          "vigil_guard_fix": "Dockerfile downloads models during build"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "Dual-Language Models",
          "file": "services/presidio-pii-api/Dockerfile",
          "description": "Downloads both en_core_web_lg and pl_core_news_lg"
        }
      ],
      "best_practices": [
        "Download large models (_lg) for better accuracy",
        "Use appropriate language model for text language",
        "Cache nlp object (expensive to create)"
      ]
    },
    "bcryptjs": {
      "name": "bcryptjs",
      "version": "^2.4.3",
      "category": "security",
      "official_docs": "https://github.com/dcodeIO/bcrypt.js#readme",
      "quick_links": {
        "api": "https://github.com/dcodeIO/bcrypt.js#api"
      },
      "used_in": [
        "services/web-ui/backend (password hashing)"
      ],
      "common_apis": [
        {
          "name": "bcrypt.hash(password, rounds)",
          "description": "Hash password asynchronously",
          "example": "const hash = await bcrypt.hash('password123', 12)"
        },
        {
          "name": "bcrypt.compare(password, hash)",
          "description": "Compare password with hash",
          "example": "const match = await bcrypt.compare('password123', hash)"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Low salt rounds = weak security",
          "description": "Using <10 rounds makes hashing too fast, vulnerable to brute force",
          "solution": "Use 12 rounds (Vigil Guard standard)",
          "vigil_guard_fix": "services/web-ui/backend/src/auth.ts - bcrypt.hash(password, 12)"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "Password Hashing",
          "file": "services/web-ui/backend/src/auth.ts",
          "description": "12 rounds for secure hashing"
        }
      ],
      "best_practices": [
        "Use 12 rounds for balance between security and performance",
        "Always use async methods (hash, compare)",
        "Never store plaintext passwords",
        "Force password change on first login"
      ]
    },
    "jsonwebtoken": {
      "name": "jsonwebtoken",
      "version": "^9.0.2",
      "category": "security",
      "official_docs": "https://github.com/auth0/node-jsonwebtoken#readme",
      "quick_links": {
        "api": "https://github.com/auth0/node-jsonwebtoken#api"
      },
      "used_in": [
        "services/web-ui/backend (JWT authentication)"
      ],
      "common_apis": [
        {
          "name": "jwt.sign(payload, secret, options)",
          "description": "Create JWT token",
          "example": "const token = jwt.sign({ userId: 1 }, process.env.JWT_SECRET, { expiresIn: '24h' })"
        },
        {
          "name": "jwt.verify(token, secret)",
          "description": "Verify and decode JWT token",
          "example": "const decoded = jwt.verify(token, process.env.JWT_SECRET)"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Weak secret key",
          "description": "Short JWT secret makes tokens vulnerable to brute force",
          "solution": "Use minimum 32 characters random secret (from .env)",
          "vigil_guard_fix": ".env JWT_SECRET=<32+ chars>"
        },
        {
          "issue": "No token expiration",
          "description": "Tokens valid forever = security risk",
          "solution": "Always set expiresIn option (24h in Vigil Guard)",
          "vigil_guard_fix": "services/web-ui/backend/src/auth.ts - expiresIn: '24h'"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "JWT Authentication",
          "file": "services/web-ui/backend/src/auth.ts",
          "description": "Token generation with 24h expiration"
        },
        {
          "pattern": "Auth Middleware",
          "file": "services/web-ui/backend/src/auth.ts",
          "lines": "99-111",
          "description": "JWT verification middleware"
        }
      ],
      "best_practices": [
        "Use strong secret (32+ chars from .env)",
        "Set token expiration (expiresIn)",
        "Verify token on every protected route",
        "Include minimal data in payload (no sensitive info)",
        "Use httpOnly cookies for token storage"
      ]
    },
    "grafana": {
      "name": "Grafana",
      "version": "12.2.1",
      "category": "monitoring",
      "official_docs": "https://grafana.com/docs/grafana/latest/",
      "quick_links": {
        "dashboards": "https://grafana.com/docs/grafana/latest/dashboards/",
        "panels": "https://grafana.com/docs/grafana/latest/panels/",
        "datasources": "https://grafana.com/docs/grafana/latest/datasources/"
      },
      "used_in": [
        "services/monitoring/grafana"
      ],
      "common_apis": [
        {
          "name": "ClickHouse datasource",
          "description": "Connect to ClickHouse database",
          "example": "SELECT * FROM n8n_logs WHERE $__timeFilter(timestamp)"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Volume permissions on macOS",
          "description": "Grafana can't write to mounted volume",
          "solution": "Set GRAFANA_UID/GID in .env to match host user",
          "vigil_guard_fix": ".env GRAFANA_UID=$(id -u), GRAFANA_GID=$(id -g)"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "Threat Detection Dashboard",
          "file": "services/monitoring/grafana/dashboards/",
          "description": "Real-time monitoring of detection events"
        }
      ],
      "best_practices": [
        "Use $__timeFilter for time-based queries",
        "Create reusable templates for dashboards",
        "Set appropriate refresh intervals",
        "Use variables for dynamic dashboards"
      ]
    },
    "caddy": {
      "name": "Caddy",
      "version": "2-alpine",
      "category": "proxy",
      "official_docs": "https://caddyserver.com/docs/",
      "quick_links": {
        "caddyfile": "https://caddyserver.com/docs/caddyfile",
        "directives": "https://caddyserver.com/docs/caddyfile/directives"
      },
      "used_in": [
        "services/proxy"
      ],
      "common_apis": [
        {
          "name": "reverse_proxy",
          "description": "Proxy requests to backend",
          "example": "reverse_proxy web-ui-frontend:80"
        },
        {
          "name": "uri strip_prefix",
          "description": "Remove path prefix before proxying",
          "example": "uri strip_prefix /ui"
        }
      ],
      "known_pitfalls": [
        {
          "issue": "Path prefix handling",
          "description": "Need to strip /ui prefix before proxying to nginx",
          "solution": "Use uri strip_prefix /ui in Caddyfile",
          "vigil_guard_fix": "services/proxy/Caddyfile - handle /ui/* { uri strip_prefix /ui; ... }"
        }
      ],
      "vigil_guard_patterns": [
        {
          "pattern": "Multi-Service Proxy",
          "file": "services/proxy/Caddyfile",
          "description": "Routes /ui to frontend, /api to backend, / to n8n"
        }
      ],
      "best_practices": [
        "Use uri strip_prefix for path-based routing",
        "Enable automatic HTTPS in production",
        "Configure proper CORS headers",
        "Use reverse_proxy for backend services"
      ]
    }
  },
  "categories": {
    "backend": ["express", "bcryptjs", "jsonwebtoken"],
    "frontend": ["react", "vite", "tailwindcss"],
    "testing": ["vitest"],
    "database": ["clickhouse", "grafana"],
    "ai": ["presidio", "spacy"],
    "infrastructure": ["docker", "caddy"],
    "workflow": ["n8n"],
    "language": ["typescript"],
    "security": ["bcryptjs", "jsonwebtoken"],
    "monitoring": ["grafana"],
    "proxy": ["caddy"],
    "build_tool": ["vite"],
    "styling": ["tailwindcss"]
  },
  "stats": {
    "total_technologies": 15,
    "total_patterns": 20,
    "total_pitfalls": 17,
    "total_best_practices": 95
  }
}
